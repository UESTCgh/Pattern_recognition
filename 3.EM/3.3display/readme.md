---

# 自动抠图与分割工具

该工具是一个基于Python与Tkinter开发的自动抠图和分割应用，用户可以方便地对图像进行抠图，并使用高斯混合模型（GMM）对图像进行分割。通过图形用户界面（GUI），用户可以轻松选择图像、分割模型，观察GMM模型的训练过程和分割效果。

## 功能概述

- **图像抠图**：提供多种抠图算法，包括GrabCut和颜色过滤。
- **图像分割**：基于GMM（高斯混合模型）的聚类方法对抠图后的图像进行分割。
- **GMM 训练**：可以对自定义数据集进行GMM训练，支持可视化训练过程。
- **参数自定义**：允许用户配置训练参数，如聚类个数、最大迭代次数等。

## 项目依赖

本项目依赖于以下Python库：

- **Python 3.6 及以上**
- **Tkinter**：用于构建图形用户界面。
- **Pillow (PIL)**：用于图像的加载、缩放和处理。
- **OpenCV (cv2)**：用于图像处理，例如抠图、边缘检测等。
- **NumPy**：用于数值计算。
- **scikit-learn (sklearn)**：用于GMM模型的训练与预测。
- **Matplotlib**：用于GMM模型训练过程的可视化。
- **SciPy**：用于加载`.mat`格式的数据集。
- **Joblib**：用于模型的保存和加载。

安装依赖库的命令如下：

```sh
pip install numpy opencv-python-headless Pillow matplotlib scikit-learn scipy joblib
```

## 使用说明

1. **启动程序**：

   运行程序可通过命令行执行以下命令：
   ```sh
   python main.py
   ```
   启动后会显示两个功能标签：“分割工具”和“GMM 训练工具”。

2. **分割工具**：

   - **选择图像文件**：从本地选择待处理的图像。
   - **加载分割模型**：加载已训练好的GMM模型（`.pkl`格式）。
   - **确认抠图**：选择一种抠图算法，提取鱼类部分。
   - **确认分割**：基于GMM模型对抠图后的图像进行聚类分割，并可视化分割效果。

3. **GMM 训练工具**：

   - **选择数据集**：加载一个包含灰度或RGB数据的 `.mat` 文件。
   - **设置训练参数**：配置聚类个数、最大训练迭代次数等参数。
   - **训练并可视化**：对数据集进行GMM训练，并实时可视化训练过程。

## 项目目录结构

- **main.py**：项目主程序，包含了所有的GUI逻辑和功能实现。
- **combined**：保存合成图像的目录。
- **result**：保存抠图和分割结果，分为`GrabCut`和`ColorFilter`子文件夹。

## 主要功能

### 图像抠图

1. **GrabCut算法**：
   - 使用OpenCV的GrabCut算法实现鱼类从背景中的提取。
2. **颜色过滤算法**：
   - 使用HSV颜色空间过滤橙色和白色，结合形态学操作实现鱼类的提取。

### GMM训练

- 提供灰度和RGB数据的GMM训练功能，支持用户自定义训练参数。
- 通过`matplotlib`动画功能，用户可以直观地看到GMM模型的训练过程。
- 模型训练结束后自动保存到指定目录中。

### 图像分割

- 加载预先训练的GMM模型，对抠图后的图像进行分割。
- 支持灰度和RGB图像的分割，分割结果会自动保存并在界面上进行显示。

### 文件管理

- 抠图和分割结果文件分别保存在 `GrabCut` 和 `ColorFilter` 子文件夹中，便于管理。
- 分割结果会根据不同的模式（RGB或灰度）自动生成具有后缀区分的文件名。

## 使用示例

1. **选择图片并进行抠图**：
   - 打开程序后，首先选择待处理的图像文件。
   - 然后选择抠图算法（GrabCut或颜色过滤），点击“确认抠图”按钮，处理结果将显示在界面下方。

2. **加载分割模型并进行分割**：
   - 加载已训练好的GMM模型。
   - 点击“确认分割”按钮，模型会对抠图后的图像进行分割，并展示分割结果。

3. **训练GMM模型**：
   - 在“GMM 训练工具”页面，选择数据集并设置训练参数。
   - 点击“灰度数据训练”或“RGB 数据训练”按钮，开始训练并可视化GMM训练过程。

## 注意事项

- **数据集要求**：数据集文件需要是`.mat`格式，并包含用于训练的`array_sample`字段。
- **顺序执行**：部分操作需要按顺序执行，如需先选择数据集后再进行模型训练。
- **目录管理**：分割结果将自动保存至 `result` 目录下的 `GrabCut` 和 `ColorFilter` 子目录中，文件名根据使用的模式进行标识。

## 许可证

本项目基于MIT许可证开源，欢迎大家自由使用与修改代码。

